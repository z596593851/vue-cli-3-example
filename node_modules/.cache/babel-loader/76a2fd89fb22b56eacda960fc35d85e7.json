{"remainingRequest":"/Users/apple/code/js/vue-cli-3-example/node_modules/babel-loader/lib/index.js!/Users/apple/code/js/vue-cli-3-example/node_modules/@vux/loader/src/js-loader.js!/Users/apple/code/js/vue-cli-3-example/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/apple/code/js/vue-cli-3-example/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/code/js/vue-cli-3-example/node_modules/@vux/loader/src/script-loader.js!/Users/apple/code/js/vue-cli-3-example/node_modules/vux/src/components/week-calendar/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/vux/src/components/week-calendar/index.vue","mtime":499162500000},{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/@vux/loader/src/js-loader.js","mtime":499162500000},{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/apple/code/js/vue-cli-3-example/node_modules/@vux/loader/src/script-loader.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Flexbox, FlexboxItem } from \"../flexbox\";\nimport { Swiper, SwiperItem } from \"../swiper\";\nimport dateFormat from \"../../tools/date/format\";\nimport calendarMarksMixin from \"../../mixins/calendar-marks\";\n/**\nimport { Flexbox, FlexboxItem, Swiper, SwiperItem, dateFormat } from 'vux'\n**/\n\nvar getNextIndex = function getNextIndex(index) {\n  if (index === 2) {\n    return 0;\n  }\n\n  if (index === 0) {\n    return 1;\n  }\n\n  return 2;\n};\n\nvar getPrevIndex = function getPrevIndex(index) {\n  if (index === 2) {\n    return 1;\n  }\n\n  if (index === 1) {\n    return 0;\n  }\n\n  if (index === 0) {\n    return 2;\n  }\n};\n\nvar indexMap = {\n  0: 'last',\n  1: 'current',\n  2: 'next'\n};\nexport default {\n  mixins: [calendarMarksMixin],\n  components: {\n    Swiper: Swiper,\n    SwiperItem: SwiperItem,\n    Flexbox: Flexbox,\n    FlexboxItem: FlexboxItem\n  },\n  props: {\n    value: String,\n    height: {\n      type: String,\n      default: '65px'\n    },\n    marks: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    [0, 7, -7].forEach(function (item) {\n      _this.getThisWeekRange(item);\n    });\n  },\n  mounted: function mounted() {\n    this.index = 1;\n  },\n  watch: {\n    value: function value(val) {\n      this.currentValue = val;\n      this.changeData(null, this.index, val);\n    },\n    currentValue: function currentValue(val) {\n      this.$emit('input', val);\n      this.$emit('on-change', val);\n    },\n    currentMonth: function currentMonth(val) {\n      var value = this.currentMonth.split('-');\n      var data = {\n        year: value[0],\n        month: value[1]\n      };\n      this.$emit('on-year-month-change', data);\n    }\n  },\n  data: function data() {\n    return {\n      currentValue: this.value,\n      index: 0,\n      lastWeekList: [],\n      currentWeekList: [],\n      nextWeekList: [],\n      startDate: dateFormat(new Date(), 'YYYY-MM-DD'),\n      currentMonth: '',\n      changeCount: -1,\n      hasRender: false\n    };\n  },\n  methods: {\n    switchViewToCurrentValue: function switchViewToCurrentValue() {\n      if (this.currentValue) {\n        this.changeData(null, this.index, this.currentValue);\n      }\n    },\n    switchViewToMonth: function switchViewToMonth(year, month) {\n      this.changeData(null, this.index, \"\".concat(year, \"-\").concat(month, \"-01\"));\n    },\n    switchViewToToday: function switchViewToToday() {\n      var today = dateFormat(new Date(), 'YYYY-MM-DD');\n      this.changeData(null, this.index, today);\n    },\n    onClick: function onClick(i) {\n      this.currentValue = i.format;\n    },\n    onIndexChange: function onIndexChange(newIndex) {\n      var el = document.querySelector('#x000' + newIndex);\n      var start = el.getAttribute('data-start');\n      var date = new Date(start);\n      this.changeData(date, newIndex);\n    },\n    changeData: function changeData(date, index, value) {\n      var _this2 = this;\n\n      // if has value, reset start\n      if (value) {\n        var _date = new Date(value.replace(/-/g, '/'));\n\n        date = new Date(_date.setDate(_date.getDate() - _date.getDay()));\n        this[indexMap[index] + 'WeekList'] = this.getWeekRange(new Date(date.setDate(date.getDate())));\n      }\n\n      this.startDate = dateFormat(date, 'YYYY-MM-DD');\n      var lastMonth = dateFormat(date.getTime() + 6 * 24 * 3600 * 1000, 'YYYY-MM');\n      this.currentMonth = lastMonth;\n      var nextIndex = getNextIndex(index);\n      var nextKey = indexMap[nextIndex];\n      this[nextKey + 'WeekList'] = this.getWeekRange(new Date(date.setDate(date.getDate() + 7)));\n      var lastIndex = getPrevIndex(index);\n      var lastKey = indexMap[lastIndex];\n      this[lastKey + 'WeekList'] = this.getWeekRange(new Date(date.setDate(date.getDate() - 14)));\n      this.$nextTick(function () {\n        _this2.changeCount++;\n\n        _this2.$emit('on-view-change', {\n          allDates: _this2[indexMap[_this2.index] + 'WeekList']\n        }, _this2.changeCount);\n      });\n    },\n    getCurrentDates: function getCurrentDates() {\n      return this[indexMap[this.index] + 'WeekList'];\n    },\n    getCurrentYearMonth: function getCurrentYearMonth() {\n      var value = this.currentMonth.split('-');\n      return {\n        year: value[0],\n        month: value[1]\n      };\n    },\n    isToday: function isToday(date) {\n      return dateFormat(date, 'YYYY-MM-DD') === dateFormat(new Date(), 'YYYY-MM-DD');\n    },\n    isSelected: function isSelected(date) {\n      return dateFormat(date, 'YYYY-MM-DD') === this.date;\n    },\n    isWeekend: function isWeekend(date) {\n      return date.getDay() === 0 || date.getDay() === 6;\n    },\n    getWeekRange: function getWeekRange(start) {\n      var rs = [{\n        format: dateFormat(start, 'YYYY-MM-DD'),\n        formatedDate: dateFormat(start, 'YYYY-MM-DD'),\n        date: start,\n        str: dateFormat(start, 'D'),\n        isWeekend: this.isWeekend(start),\n        isToday: this.isWeekend(start),\n        isSelected: this.isSelected(start),\n        _date: start.getDate()\n      }];\n\n      for (var i = 1; i < 7; i++) {\n        var current = start;\n        current.setDate(current.getDate() + 1);\n        rs.push({\n          format: dateFormat(current, 'YYYY-MM-DD'),\n          date: current,\n          str: dateFormat(current, 'D'),\n          formatedDate: dateFormat(current, 'YYYY-MM-DD'),\n          isWeekend: this.isWeekend(current),\n          isToday: this.isToday(current),\n          isSelected: this.isSelected(current),\n          _date: current.getDate()\n        });\n      }\n\n      return rs;\n    },\n    getThisWeekRange: function getThisWeekRange() {\n      var day = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var start = arguments.length > 1 ? arguments[1] : undefined;\n      var now = start || new Date();\n      var firstday = new Date(now.setDate(now.getDate() - now.getDay() + day));\n\n      if (day === 0) {\n        this.currentWeekList = this.getWeekRange(firstday);\n      }\n\n      if (day === 7) {\n        this.nextWeekList = this.getWeekRange(firstday);\n      }\n\n      if (day === -7) {\n        this.lastWeekList = this.getWeekRange(firstday);\n      }\n    }\n  }\n};",{"version":3,"sources":["/Users/apple/code/js/vue-cli-3-example/node_modules/vux/src/components/week-calendar/index.vue"],"names":["Flexbox","FlexboxItem","Swiper","SwiperItem","dateFormat","calendarMarksMixin","getNextIndex","index","getPrevIndex","indexMap","mixins","components","props","value","String","height","type","default","marks","Array","created","forEach","item","getThisWeekRange","mounted","watch","val","currentValue","changeData","$emit","currentMonth","split","data","year","month","lastWeekList","currentWeekList","nextWeekList","startDate","Date","changeCount","hasRender","methods","switchViewToCurrentValue","switchViewToMonth","switchViewToToday","today","onClick","i","format","onIndexChange","newIndex","el","document","querySelector","start","getAttribute","date","_date","replace","setDate","getDate","getDay","getWeekRange","lastMonth","getTime","nextIndex","nextKey","lastIndex","lastKey","$nextTick","allDates","getCurrentDates","getCurrentYearMonth","isToday","isSelected","isWeekend","rs","formatedDate","str","current","push","day","now","firstday"],"mappings":"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","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { Flexbox, FlexboxItem } from '../flexbox'\nimport { Swiper, SwiperItem } from '../swiper'\nimport dateFormat from '../../tools/date/format'\nimport calendarMarksMixin from '../../mixins/calendar-marks'\n\n/**\nimport { Flexbox, FlexboxItem, Swiper, SwiperItem, dateFormat } from 'vux'\n**/\n\nconst getNextIndex = (index) => {\n  if (index === 2) {\n    return 0\n  }\n  if (index === 0) {\n    return 1\n  }\n  return 2\n}\n\nconst getPrevIndex = index => {\n  if (index === 2) {\n    return 1\n  }\n  if (index === 1) {\n    return 0\n  }\n  if (index === 0) {\n    return 2\n  }\n}\n\nconst indexMap = {\n  0: 'last',\n  1: 'current',\n  2: 'next'\n}\n\nexport default {\n  mixins: [calendarMarksMixin],\n  components: {\n    Swiper,\n    SwiperItem,\n    Flexbox,\n    FlexboxItem\n  },\n  props: {\n    value: String,\n    height: {\n      type: String,\n      default: '65px'\n    },\n    marks: {\n      type: Array,\n      default () {\n        return []\n      }\n    }\n  },\n  created () {\n    [0, 7, -7].forEach(item => {\n      this.getThisWeekRange(item)\n    })\n  },\n  mounted () {\n    this.index = 1\n  },\n  watch: {\n    value (val) {\n      this.currentValue = val\n      this.changeData(null, this.index, val)\n    },\n    currentValue (val) {\n      this.$emit('input', val)\n      this.$emit('on-change', val)\n    },\n    currentMonth (val) {\n      const value = this.currentMonth.split('-')\n      const data = {\n        year: value[0],\n        month: value[1]\n      }\n      this.$emit('on-year-month-change', data)\n    }\n  },\n  data () {\n    return {\n      currentValue: this.value,\n      index: 0,\n      lastWeekList: [],\n      currentWeekList: [],\n      nextWeekList: [],\n      startDate: dateFormat(new Date(), 'YYYY-MM-DD'),\n      currentMonth: '',\n      changeCount: -1,\n      hasRender: false\n    }\n  },\n  methods: {\n    switchViewToCurrentValue () {\n      if (this.currentValue) {\n        this.changeData(null, this.index, this.currentValue)\n      }\n    },\n    switchViewToMonth (year, month) {\n      this.changeData(null, this.index, `${year}-${month}-01`)\n    },\n    switchViewToToday () {\n      const today = dateFormat(new Date(), 'YYYY-MM-DD')\n      this.changeData(null, this.index, today)\n    },\n    onClick (i) {\n      this.currentValue = i.format\n    },\n    onIndexChange (newIndex) {\n      let el = document.querySelector('#x000' + newIndex)\n      const start = el.getAttribute('data-start')\n      const date = new Date(start)\n      this.changeData(date, newIndex)\n    },\n    changeData (date, index, value) {\n      // if has value, reset start\n      if (value) {\n        const _date = new Date(value.replace(/-/g, '/'))\n        date = new Date(_date.setDate(_date.getDate() - _date.getDay()))\n        this[indexMap[index] + 'WeekList'] = this.getWeekRange(new Date(date.setDate(date.getDate())))\n      }\n\n      this.startDate = dateFormat(date, 'YYYY-MM-DD')\n\n      const lastMonth = dateFormat(date.getTime() + 6 * 24 * 3600 * 1000, 'YYYY-MM')\n      this.currentMonth = lastMonth\n\n      const nextIndex = getNextIndex(index)\n      const nextKey = indexMap[nextIndex]\n      this[nextKey + 'WeekList'] = this.getWeekRange(new Date(date.setDate(date.getDate() + 7)))\n      const lastIndex = getPrevIndex(index)\n      const lastKey = indexMap[lastIndex]\n      this[lastKey + 'WeekList'] = this.getWeekRange(new Date(date.setDate(date.getDate() - 14)))\n\n      this.$nextTick(() => {\n        this.changeCount++\n        this.$emit('on-view-change', {\n          allDates: this[indexMap[this.index] + 'WeekList']\n        }, this.changeCount)\n      })\n    },\n    getCurrentDates () {\n      return this[indexMap[this.index] + 'WeekList']\n    },\n    getCurrentYearMonth () {\n      const value = this.currentMonth.split('-')\n      return {\n        year: value[0],\n        month: value[1]\n      }\n    },\n    isToday (date) {\n      return dateFormat(date, 'YYYY-MM-DD') === dateFormat(new Date(), 'YYYY-MM-DD')\n    },\n    isSelected (date) {\n      return dateFormat(date, 'YYYY-MM-DD') === this.date\n    },\n    isWeekend (date) {\n      return date.getDay() === 0 || date.getDay() === 6\n    },\n    getWeekRange (start) {\n      let rs = [{\n        format: dateFormat(start, 'YYYY-MM-DD'),\n        formatedDate: dateFormat(start, 'YYYY-MM-DD'),\n        date: start,\n        str: dateFormat(start, 'D'),\n        isWeekend: this.isWeekend(start),\n        isToday: this.isWeekend(start),\n        isSelected: this.isSelected(start),\n        _date: start.getDate()\n      }]\n      for (let i = 1; i < 7; i++) {\n        let current = start\n        current.setDate(current.getDate() + 1)\n        rs.push({\n          format: dateFormat(current, 'YYYY-MM-DD'),\n          date: current,\n          str: dateFormat(current, 'D'),\n          formatedDate: dateFormat(current, 'YYYY-MM-DD'),\n          isWeekend: this.isWeekend(current),\n          isToday: this.isToday(current),\n          isSelected: this.isSelected(current),\n          _date: current.getDate()\n        })\n      }\n      return rs\n    },\n    getThisWeekRange (day = 0, start) {\n      const now = start || new Date()\n      const firstday = new Date(now.setDate(now.getDate() - now.getDay() + day))\n      if (day === 0) {\n        this.currentWeekList = this.getWeekRange(firstday)\n      }\n      if (day === 7) {\n        this.nextWeekList = this.getWeekRange(firstday)\n      }\n      if (day === -7) {\n        this.lastWeekList = this.getWeekRange(firstday)\n      }\n    }\n  }\n}\n"]}]}